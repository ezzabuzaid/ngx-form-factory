<ng-container *ngIf="!rawField()">
  <ng-container [ngSwitch]="normalField()?.type">
    <ng-container *ngSwitchCase="types.TEXT">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ normalField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          type="text"
          matInput
          [id]="normalField().id"
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          [maxlength]="normalField().maxlength"
          [minlength]="normalField().minlength"
          [attr.autocomplete]="normalField().autocomplete"
          [formControl]="field"
        />
        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.PASSWORD">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ normalField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          [id]="normalField().id"
          #input
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          [maxlength]="normalField().maxlength"
          [minlength]="normalField().minlength"
          type="password"
          [attr.autocomplete]="normalField().autocomplete"
          matInput
          [formControl]="field"
        />
        <mat-icon
          class="password-lock-icon"
          matSuffix
          [ngxTogglePasswod]="input"
        >
          lock</mat-icon
        >
        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.TEXTAREA">
      <ngx-textarea [field]="$any(field)">
        <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
      </ngx-textarea>
    </ng-container>
    <ng-container *ngSwitchCase="types.EMAIL">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ normalField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          [id]="normalField().id"
          type="email"
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          [maxlength]="normalField().maxlength"
          [minlength]="normalField().minlength"
          matInput
          [attr.autocomplete]="normalField().autocomplete || 'email'"
          [formControl]="field"
        />
        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.NUMBER">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ normalField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          [id]="normalField().id"
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          type="number"
          matInput
          [formControl]="field"
        />

        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.DATE">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ normalField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          matInput
          [id]="normalField().id"
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          [max]="dateField().max"
          [min]="dateField().min"
          (focus)="datePicker.open()"
          [matDatepicker]="datePicker"
          [formControl]="field"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="datePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #datePicker></mat-datepicker>
        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.TIME">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ timeField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          [placeholder]="normalField().placeholder"
          [readonly]="normalField().readonly"
          [max]="timeField().max"
          [min]="timeField().min"
          [id]="timeField().id"
          matInput
          [formControl]="field"
          type="time"
        />

        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.DATETIME">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="normalField().hideRequiredMarker"
        [floatLabel]="normalField().floatLabel"
        [appearance]="normalField().appearance"
      >
        <mat-label>{{ timeField().label }}</mat-label>
        <mat-hint>{{ normalField().hint }}</mat-hint>
        <input
          [placeholder]="timeField().placeholder"
          [readonly]="timeField().readonly"
          [max]="timeField().max"
          [min]="timeField().min"
          [id]="timeField().id"
          matInput
          [formControl]="field"
          type="datetime-local"
        />

        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.CHECKBOX">
      <mat-checkbox [id]="normalField().id" [formControl]="field"
        >{{ normalField().label }}
      </mat-checkbox>
    </ng-container>
    <ng-container *ngSwitchCase="types.SELECT">
      <mat-form-field
        [class]="normalField().class"
        [hideRequiredMarker]="selectField().hideRequiredMarker"
        [floatLabel]="selectField().floatLabel"
        [appearance]="selectField().appearance"
      >
        <mat-label>{{ selectField().label }}</mat-label>
        <mat-hint>{{ selectField().hint }}</mat-hint>
        <mat-select
          [placeholder]="selectField().placeholder"
          [multiple]="selectField().multiple"
          [id]="selectField().id"
          [formControl]="field"
        >
          <mat-option
            *ngFor="let option of selectField().options | async"
            [value]="option.value"
          >
            {{ option.label }}
          </mat-option>
        </mat-select>

        <mat-error>
          <ng-container [ngTemplateOutlet]="errorTemplate"></ng-container>
        </mat-error>
      </mat-form-field>
    </ng-container>
    <ng-container *ngSwitchCase="types.RADIO">
      <mat-label>{{ selectField().label }}</mat-label>
      <mat-radio-group [id]="selectField().id">
        <mat-radio-button
          *ngFor="let option of selectField().options | async"
          [value]="option.value"
        >
          {{ option.label }}
        </mat-radio-button>
      </mat-radio-group>
    </ng-container>
    <ng-container *ngSwitchCase="types.TEL">
      <ngx-mobile-control [field]="$any(normalField())"></ngx-mobile-control>
    </ng-container>
    <ng-container *ngSwitchCase="types.COUNTRY">
      <ngx-country-control
        [id]="normalField().id"
        [field]="$any(normalField())"
      ></ngx-country-control>
    </ng-container>
    <ng-container *ngSwitchCase="types.MASK">
      <ngx-mask [field]="$any(field)"></ngx-mask>
    </ng-container>
  </ng-container>
</ng-container>

<ng-container *ngIf="rawField() as _rawField">
  <ng-container
    [dynamic-component]="_rawField.component"
    [inputs]="_rawField.inputs"
    [outputs]="_rawField.outputs"
    [properties]="{ formControl: _rawField }"
    (create)="onRawFieldCreation($event, _rawField)"
  ></ng-container>
</ng-container>

<ng-template #errorTemplate>
  <mat-error *ngFor="let error of errors()">
    <span *ngIf="normalField().hasError(error[0])">{{ error[1]() }}</span>
  </mat-error>
</ng-template>
